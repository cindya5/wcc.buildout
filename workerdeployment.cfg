[buildout]
extends = deployment.cfg 
parts = 
    instance
    instance2
    instance5
    instance6
    instanceworker
    instanceworker2
    munin1
    munin2
    munin3
    munin4
    omelette
    scripts

[instance]
shared-blob = off

[instanceworker]
<= instance

http-address = ${site:instance3-address}
shared-blob = off
zcml-additional =
    <configure xmlns="http://namespaces.zope.org/zope">
        <include package="plone.app.async" file="multi_db_worker.zcml" />
    </configure>

zope-conf-additional-local = ${site:service-zcml-conf}

zope-conf-additional =
    ${:zope-conf-additional-local}
    <zodb_db async>
        cache-size ${instance:zodb-cache-size}
        <zeoclient>
            server ${zeoserver:zeo-address}
            storage 2
            name asyncstorage
            shared-blob-dir off
            var ${buildout:directory}/var/${:_buildout_section_name_}/zeoclient
            cache-size ${instance:zeo-client-cache-size}
        </zeoclient>
        mount-point /zasync
    </zodb_db>

[instanceworker2]
<= instance
http-address = ${site:instance4-address}
shared-blob = ${instanceworker:shared-blob}
zcml-additional = ${instanceworker:zcml-additional}
zope-conf-additional-local = 
zope-conf-additional = ${instanceworker:zope-conf-additional}
